# üöÄ –ú–æ–¥–µ–ª—å–Ω—ã–π –ü–∞–π–ø–ª–∞–π–Ω –¥–ª—è –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

> "–•–æ—á–µ—à—å –±—ã—Å—Ç—Ä–æ –æ–±—É—á–∏—Ç—å –ø–∞—Ä—É –º–æ–¥–µ–ª–µ–π –∏ –Ω–µ —É—Ç–æ–Ω—É—Ç—å –≤ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞—Ö? –¢—ã –ø–æ –∞–¥—Ä–µ—Å—É."

## üì¶ –ß—Ç–æ —ç—Ç–æ?

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Å:
- –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `torchvision` –∏ `transformers`,
- –æ–±—ë—Ä—Ç–∫–æ–π –¥–ª—è –≥–∏–±–∫–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π (–¥–∞–∂–µ –∏–∑ HuggingFace),
- —Ñ—É–Ω–∫—Ü–∏–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏,
- –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Å–∞–±–º–∏—Ç–∞.

–ó–∞—á–µ–º? –ß—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤ 17-–π —Ä–∞–∑.

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/Sefixnep/Torch-Classification.git
cd Torch-Classification
pip install -r requirements.txt
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
classification/
‚îú‚îÄ‚îÄ model.py           # –û–±—ë—Ä—Ç–∫–∞ –º–æ–¥–µ–ª–µ–π (fit, predict, save, load –∏ –ø—Ä.)
‚îú‚îÄ‚îÄ data.py            # –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –¥–∞–Ω–Ω—ã–º–∏
solution.ipynb         # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è
requirements.txt       # –§–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–¥–∞-–¥–∞, —Ç—ã —ç—Ç–æ —á–∏—Ç–∞–µ—à—å)
```

---

## üß† –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞?

### üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

- –§–∏–∫—Å–∞—Ü–∏—è —Å–∏–¥–æ–≤ (`set_all_seeds()`), —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –∫–∞–∫ –≤—á–µ—Ä–∞.
- –ö–∞—Å—Ç–æ–º–Ω—ã–π `ClassificationDataset`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `{'args': [...], 'labels': ...}` –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
- –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏? –ü–æ–∫–∞ –Ω–µ—Ç, –Ω–æ —Ç—ã –∑–Ω–∞–µ—à—å, –≥–¥–µ –∏—Ö –≤—Å—Ç–∞–≤–∏—Ç—å.

### üß™ –î–∞–Ω–Ω—ã–µ

- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ `train/valid` —á–µ—Ä–µ–∑ `train_test_split()`
- `DataLoader` —Å `batch_size=12`
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ (`show_classification()`)

---

### üß∞ –ú–æ–¥–µ–ª–∏

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è **–ª—é–±—ã–µ –º–æ–¥–µ–ª–∏**, –µ—Å–ª–∏ –æ–Ω–∏:

- –ø—Ä–∏–Ω–∏–º–∞—é—Ç `x = model(*args)` (–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –æ–±—ë—Ä—Ç–∫—É),
- –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –≤–∏–¥–µ —Ç–µ–Ω–∑–æ—Ä–∞ (`logits` –∏–ª–∏ `probs`),
- –∏–º–µ—é—Ç –º–µ—Ç–æ–¥—ã `.fit()` –∏ `.predict()` (—á–µ—Ä–µ–∑ `Classifier`).

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**  
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª–∏ HuggingFace –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `__call__` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å–ª–æ–≤–∞—Ä–∏ (`{'logits': ...}`), –∞ –Ω–µ —á–∏—Å—Ç—ã–µ —Ç–µ–Ω–∑–æ—Ä—ã. –ß—Ç–æ–±—ã –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ –∫–∞–∫ –Ω–∞–¥–æ, –æ–±–µ—Ä–Ω–∏ –∏—Ö —á–µ—Ä–µ–∑ `CustomOutput`:

```python
model = CustomOutput(
    AutoModelForImageClassification.from_pretrained(...),
    output_transform=lambda out: out.logits
)
```

–ò–Ω–∞—á–µ `Classifier` –ø–æ–¥–∞–≤–∏—Ç—Å—è, –∞ —Ç—ã ‚Äî –¥–µ–±–∞–∂–∏—à—å –¥–æ –Ω–æ—á–∏.

---

### üß™ –ü–æ–¥–±–æ—Ä Learning Rate

```python
find_lr(model_wrapped)
```

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `torch_lr_finder` + –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö `DataLoader`'–æ–≤. –õ–† —Å–∞–º —Å–µ–±—è –Ω–µ –ø–æ–¥–±–µ—Ä–µ—Ç.

### üèÜ –í—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏

```python
scores = {model.best_score: model, ...}
best_model = scores[max(scores)]
```

–î–∞, –ø—Ä–æ—Å—Ç–æ. –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ –Ω–∞–¥–æ —É—Å–ª–æ–∂–Ω—è—Ç—å.

---

## üì§ –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ

```python
predict_class_id = best_model.predict(test_set)
```

–î–∞ –¥–∞, –∫–∞–∫ –≤ sklearn! –ü—Ä–æ—Å—Ç–æ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ.

---

## ‚ùì –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

–ï—Å–ª–∏ —Ç—ã —É—Å—Ç–∞–ª –≤—Ä—É—á–Ω—É—é –ø–∏—Å–∞—Ç—å —Ü–∏–∫–ª—ã –æ–±—É—á–µ–Ω–∏—è –ø–æ–¥ –∫–∞–∂–¥—É—é –º–æ–¥–µ–ª—å, –¥–µ–±–∞–∂–∏—Ç—å `dataloader`'—ã –∏ —Å–æ–±–∏—Ä–∞—Ç—å —Å–∞–±–º–∏—Ç—ã –≤—Ä—É—á–Ω—É—é ‚Äî —ç—Ç–æ —Ç–≤–æ–π —Å–ø–∞—Å–∞—Ç–µ–ª—å–Ω—ã–π –∫—Ä—É–≥. –ú–∏–Ω–∏–º—É–º –∫–æ–¥–∞, –º–∞–∫—Å–∏–º—É–º –≥–∏–±–∫–æ—Å—Ç–∏.

---
